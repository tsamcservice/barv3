<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ å¿«é€Ÿç·¨è¼¯å™¨ç³»çµ± - MTEST</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/flex2html.css">
    <script src="js/flex2html.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 2.5rem;
            color: #333;
            margin: 0;
        }
        
        .system-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        .quick-editor-system {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
        }
        .main-buttons {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        .btn-primary {
            background: rgba(255,255,255,0.95);
            color: #667eea;
            padding: 12px 24px;
            border-radius: 12px;
            text-decoration: none;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            transform: scale(1.05);
            border: 2px solid rgba(255,255,255,0.3);
            transition: all 0.3s ease;
        }
        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            text-decoration: none;
            font-size: 16px;
            font-weight: bold;
            border: 2px solid rgba(255,255,255,0.3);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }
        .btn-secondary:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        .share-platforms {
            background: rgba(255,255,255,0.1);
            padding: 1rem;
            border-radius: 12px;
            margin-top: 1rem;
        }
        .platform-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 8px;
            margin-top: 1rem;
        }
        .platform-btn {
            padding: 8px 12px;
            border-radius: 6px;
            text-decoration: none;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            transition: all 0.2s ease;
        }
        .platform-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .preview-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .feature-explanation {
            background: #e8f4ff;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }
        .admin-section {
            background: #fff5f5;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #dc3545;
        }
        .admin-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        .admin-btn {
            background: #dc3545;
            color: white;
            padding: 10px 16px;
            border-radius: 6px;
            text-decoration: none;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.2s ease;
        }
        .admin-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
        }
                 @media (max-width: 768px) {
             .main-buttons {
                 flex-direction: column;
                 align-items: center;
             }
             .btn-primary, .btn-secondary {
                 width: 100%;
                 max-width: 300px;
             }
         }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="header">
            <h1>ğŸš€ å¿«é€Ÿç·¨è¼¯å™¨ç³»çµ±</h1>
            <p style="color: #666; font-size: 18px; margin: 10px 0;">MTEST å°ˆç”¨ç‰ˆæœ¬ - å¤šå¹³å°åˆ†äº«æ¶æ§‹</p>
        </div>

        <!-- ğŸš€ å…¨æ–°å¿«é€Ÿç·¨è¼¯å™¨ç³»çµ± -->
        <div class="quick-editor-system">
            <h2 style="margin: 0 0 1rem 0; font-size: 1.5rem; font-weight: bold; text-align: center;">
                ğŸš€ å…¨æ–°å¿«é€Ÿç·¨è¼¯å™¨ç³»çµ±
            </h2>
            <p style="text-align: center; margin: 0 0 1.5rem 0; font-size: 14px; opacity: 0.9;">
                âš¡ 0.5ç§’è¼‰å…¥ | ğŸ¨ é›¢ç·šç·¨è¼¯ | ğŸ“± å¤šå¹³å°åˆ†äº« | ğŸ” å®‰å…¨æˆæ¬Š
            </p>
            
                         <!-- ç™»å…¥ç‹€æ…‹æç¤º -->
             <div id="loginStatus" class="feature-explanation" style="background: rgba(255,255,255,0.1); color: white; margin-bottom: 1.5rem;">
                 <h3 style="margin: 0 0 10px 0; font-size: 16px;">ğŸ“‹ ç³»çµ±ç‹€æ…‹</h3>
                 <div id="statusContent" style="font-size: 14px; line-height: 1.6;">
                     <p style="margin: 5px 0;">ğŸ” æ­£åœ¨æª¢æŸ¥ç™»å…¥ç‹€æ…‹...</p>
                 </div>
             </div>
            
                         <!-- ä¸»è¦å…¥å£æŒ‰éˆ• -->
             <div class="main-buttons">
                 <a href="#" onclick="smartEdit(); return false;" id="editBtn" class="btn-primary">
                     âš¡ æ™ºèƒ½ç·¨è¼¯
                 </a>
                 <a href="#" onclick="forceLogin(); return false;" class="btn-secondary">
                     ğŸ‘¤ é‡æ–°ç™»å…¥
                 </a>
             </div>
            
            <!-- åˆ†äº«å¹³å°æŒ‰éˆ•ç¾¤ -->
            <div class="share-platforms">
                <h4 style="margin: 0 0 1rem 0; font-size: 14px; text-align: center; opacity: 0.9;">
                    ğŸ“± å¤šå¹³å°åˆ†äº«ç³»çµ±
                </h4>
                <div class="platform-grid">
                    <a href="/line-auth-bridge.html" class="platform-btn" style="background: #00C300; color: white;">
                        ğŸ“± LINEæˆæ¬Š
                    </a>
                    <a href="/share-email.html" class="platform-btn" style="background: #EA4335; color: white;">
                        ğŸ“§ EMAILåˆ†äº«
                    </a>
                    <a href="/share-facebook.html" class="platform-btn" style="background: #1877F2; color: white;">
                        ğŸ“˜ Facebook
                    </a>
                    <a href="/share-universal.html" class="platform-btn" style="background: #6C757D; color: white;">
                        ğŸŒ å…¶ä»–å¹³å°
                    </a>
                </div>
            </div>
        </div>

        <!-- å³æ™‚é è¦½å€ - å–®ä¸€å€å¡Š -->
        <div class="preview-container">
            <h2 style="margin: 0 0 20px 0; color: #333; text-align: center;">ğŸ‘€ å³æ™‚é è¦½ - M01001æœƒå“¡å¡</h2>
            <div id="flex2html" style="max-width: 400px; margin: 0 auto;"></div>
            <div style="text-align: center; margin-top: 15px; font-size: 14px; color: #666;">
                <p>ğŸ“‹ é€™æ˜¯è³‡æ–™åº«ä¸­çš„ M01001 æœƒå“¡å¡ç¯„ä¾‹</p>
                <p>ğŸ¨ é»æ“Šã€Œç«‹å³ç·¨è¼¯ã€æˆ–ã€ŒLINEç™»å…¥ã€é–‹å§‹å€‹äººåŒ–ç·¨è¼¯</p>
            </div>
        </div>
    </div>

    <script src="js/editor.js"></script>
    <script>
        // M01001 æœƒå“¡å¡ JSON è³‡æ–™
        const m01001CardData = {
            "type": "flex",
            "altText": "æˆ‘åœ¨å‘ˆç’½/å‘ˆç’½",
            "contents": {
                "type": "bubble",
                "size": "mega",
                "body": {
                    "type": "box",
                    "layout": "vertical",
                    "contents": [
                        {
                            "type": "image",
                            "size": "full",
                            "aspectRatio": "1:1",
                            "aspectMode": "cover",
                            "url": "https://barv3.vercel.app/uploads/vip/TS-B1.png"
                        },
                        {
                            "type": "image",
                            "url": "https://barv3.vercel.app/uploads/vip/APNG1.png",
                            "size": "full",
                            "aspectRatio": "1:1",
                            "animated": true,
                            "aspectMode": "cover",
                            "position": "absolute",
                            "action": {
                                "type": "uri",
                                "label": "action",
                                "uri": "https://secure.smore.com/n/td1qc"
                            }
                        },
                        {
                            "type": "box",
                            "width": "90px",
                            "layout": "horizontal",
                            "spacing": "none",
                            "contents": [
                                {
                                    "type": "box",
                                    "action": {
                                        "uri": "https://lihi3.cc/ZWV2u",
                                        "type": "uri",
                                        "label": "VIPæœƒå“¡è™Ÿç¢¼"
                                    },
                                    "layout": "vertical",
                                    "contents": [
                                        {
                                            "url": "https://barv3.vercel.app/uploads/vip/icon_calendar.png",
                                            "type": "image",
                                            "action": {
                                                "uri": "https://lihi3.cc/ZWV2u",
                                                "type": "uri",
                                                "label": "action"
                                            },
                                            "size": "35px"
                                        },
                                        {
                                            "type": "text",
                                            "text": "TSAMC",
                                            "size": "10px",
                                            "align": "center",
                                            "gravity": "center",
                                            "offsetTop": "30px",
                                            "position": "absolute",
                                            "offsetStart": "12px",
                                            "color": "#FFFFFF"
                                        }
                                    ],
                                    "cornerRadius": "30px",
                                    "backgroundColor": "#A4924A"
                                },
                                {
                                    "type": "box",
                                    "action": {
                                        "uri": "https://lihi.cc/jl7Pw",
                                        "type": "uri",
                                        "label": "æ„›å¿ƒæœƒå“¡è™Ÿç¢¼"
                                    },
                                    "layout": "vertical",
                                    "contents": [
                                        {
                                            "url": "https://barv3.vercel.app/uploads/vip/loveicon.png",
                                            "type": "image",
                                            "action": {
                                                "uri": "https://lihi.cc/jl7Pw",
                                                "type": "uri",
                                                "label": "action"
                                            },
                                            "size": "32px"
                                        },
                                        {
                                            "type": "text",
                                            "size": "10px",
                                            "align": "center",
                                            "gravity": "center",
                                            "position": "absolute",
                                            "offsetTop": "30px",
                                            "offsetStart": "12px",
                                            "text": "0000",
                                            "color": "#FFFFFF"
                                        }
                                    ],
                                    "cornerRadius": "30px",
                                    "backgroundColor": "#d00308"
                                }
                            ],
                            "offsetTop": "250px",
                            "offsetStart": "10px",
                            "height": "45px",
                            "position": "absolute"
                        },
                        {
                            "size": "20px",
                            "text": "æˆ‘åœ¨å‘ˆç’½",
                            "type": "text",
                            "align": "center",
                            "color": "#000000",
                            "weight": "bold",
                            "margin": "md"
                        },
                        {
                            "type": "box",
                            "layout": "vertical",
                            "contents": [
                                {
                                    "type": "text",
                                    "text": "æˆ‘åœ¨å‘ˆç’½ï¼Œæ¬£è³ç¾å¥½å¹¸ç¦ï¼æˆ‘åœ¨å‘ˆç’½ï¼Œå–èŒ¶å–å’–å•¡å¾ˆæ‚ é–’ï¼ï¼æˆ‘ä¸åœ¨å‘ˆç’½ï¼Œå°±æ˜¯åœ¨å‰å¾€å‘ˆç’½çš„è·¯ä¸Šï¼ï¼ï¼",
                                    "wrap": true,
                                    "size": "16px",
                                    "margin": "sm",
                                    "color": "#000000"
                                }
                            ],
                            "paddingEnd": "65px",
                            "paddingStart": "5px",
                            "height": "95px"
                        },
                        {
                            "type": "box",
                            "width": "65px",
                            "layout": "vertical",
                            "spacing": "none",
                            "contents": [
                                {
                                    "type": "box",
                                    "action": {
                                        "uri": "https://secure.smore.com/n/td1qc",
                                        "type": "uri",
                                        "label": "action"
                                    },
                                    "layout": "vertical",
                                    "contents": [
                                        {
                                            "url": "https://barv3.vercel.app/uploads/vip/TS-LOGO.png",
                                            "type": "image",
                                            "action": {
                                                "uri": "https://secure.smore.com/n/td1qc",
                                                "type": "uri",
                                                "label": "å®˜ç¶²"
                                            },
                                            "aspectRatio": "1:1",
                                            "aspectMode": "cover",
                                            "backgroundColor": "#E1E6E0"
                                        }
                                    ],
                                    "cornerRadius": "35px",
                                    "borderWidth": "semi-bold",
                                    "borderColor": "#a4924c"
                                },
                                {
                                    "type": "box",
                                    "layout": "horizontal",
                                    "contents": [
                                        {
                                            "type": "text",
                                            "size": "14px",
                                            "text": "å‘ˆç’½",
                                            "style": "italic",
                                            "color": "#a4924c",
                                            "align": "center",
                                            "weight": "bold",
                                            "wrap": true,
                                            "margin": "none"
                                        }
                                    ],
                                    "paddingAll": "none",
                                    "cornerRadius": "none",
                                    "margin": "none",
                                    "spacing": "none"
                                }
                            ],
                            "position": "absolute",
                            "offsetEnd": "5px",
                            "margin": "md",
                            "offsetTop": "315px"
                        },
                        {
                            "type": "box",
                            "layout": "horizontal",
                            "contents": [
                                {
                                    "type": "button",
                                    "action": {
                                        "type": "uri",
                                        "label": "åŠ å‘ˆç’½å¥½å‹",
                                        "uri": "https://lin.ee/JLLIBlP"
                                    },
                                    "color": "#a4924a",
                                    "style": "primary",
                                    "height": "sm",
                                    "offsetEnd": "1px"
                                },
                                {
                                    "type": "button",
                                    "action": {
                                        "type": "uri",
                                        "label": "åˆ†äº«çµ¦å¥½å‹",
                                        "uri": "https://liff.line.me/2007327814-BdWpj70m?pageId=M01001"
                                    },
                                    "color": "#a4924b",
                                    "style": "primary",
                                    "height": "sm",
                                    "offsetStart": "1px"
                                }
                            ],
                            "margin": "md"
                        }
                    ],
                    "backgroundColor": "#E1E6E0",
                    "paddingAll": "10px"
                },
                "footer": {
                    "type": "box",
                    "layout": "horizontal",
                    "spacing": "none",
                    "contents": [
                        {
                            "type": "text",
                            "text": "å‘ˆç’½å…ƒå®‡å®™3Då±•è¦½é¤¨",
                            "wrap": true,
                            "color": "#00000050",
                            "align": "center",
                            "action": {
                                "type": "uri",
                                "label": "action",
                                "uri": "https://lihi3.cc/LY5qf"
                            },
                            "size": "sm",
                            "margin": "none"
                        }
                    ],
                    "backgroundColor": "#E1E6E0",
                    "height": "30px",
                    "margin": "none",
                    "paddingAll": "2px"
                },
                "styles": {
                    "footer": {
                        "separatorColor": "#000000",
                        "separator": true
                    }
                }
            }
        };

                 // é é¢è¼‰å…¥æ™‚é¡¯ç¤º M01001 æœƒå“¡å¡ä¸¦æª¢æŸ¥ç™»å…¥ç‹€æ…‹
         window.onload = function() {
             flex2html('flex2html', m01001CardData);
             checkLoginStatus();
             
             // ç›£è½localStorageè®ŠåŒ–ï¼ˆç•¶ç”¨æˆ¶å¾å…¶ä»–åˆ†é ç™»å…¥æ™‚ï¼‰
             window.addEventListener('storage', function(e) {
                 if (e.key === 'lineUserProfile' || e.key === 'lineAuthCompleted') {
                     checkLoginStatus();
                 }
             });
             
             // æª¢æŸ¥URLåƒæ•¸ï¼ˆå¾LINEæˆæ¬Šå›ä¾†ï¼‰
             const urlParams = new URLSearchParams(window.location.search);
             if (urlParams.get('authSuccess')) {
                 setTimeout(checkLoginStatus, 500); // å»¶é²æª¢æŸ¥ä»¥ç¢ºä¿localStorageå·²æ›´æ–°
             }
         };
        
        // æ™ºèƒ½ç·¨è¼¯ç³»çµ± - åŠ å¼·ç™»å…¥ç‹€æ…‹æª¢æŸ¥
        function checkLoginStatus() {
            const lineProfile = localStorage.getItem('lineUserProfile');
            const authCompleted = localStorage.getItem('lineAuthCompleted');
            const statusContent = document.getElementById('statusContent');
            const editBtn = document.getElementById('editBtn');
            
            // æ›´åš´æ ¼çš„ç™»å…¥ç‹€æ…‹æª¢æŸ¥
            let isValidLogin = false;
            let userData = null;
            
            if (lineProfile && authCompleted) {
                try {
                    userData = JSON.parse(lineProfile);
                    // æª¢æŸ¥å¿…è¦æ¬„ä½å’Œæ™‚æ•ˆæ€§ï¼ˆ24å°æ™‚å…§ï¼‰
                    if (userData.userId && userData.displayName && userData.timestamp) {
                        const now = Date.now();
                        const loginTime = userData.timestamp;
                        const hoursPassed = (now - loginTime) / (1000 * 60 * 60);
                        
                        if (hoursPassed < 24) {
                            isValidLogin = true;
                        }
                    }
                } catch (e) {
                    console.error('Invalid lineProfile data:', e);
                    // æ¸…ç†æå£çš„è³‡æ–™
                    localStorage.removeItem('lineUserProfile');
                    localStorage.removeItem('lineAuthCompleted');
                }
            }
            
            if (isValidLogin && userData) {
                // å·²ç™»å…¥ç‹€æ…‹
                statusContent.innerHTML = `
                    <p style="margin: 5px 0;">âœ… <strong>å·²ç™»å…¥</strong> - æ­¡è¿ï¼Œ${userData.displayName}ï¼</p>
                    <p style="margin: 5px 0;">ğŸ¯ é»æ“Šã€Œæ™ºèƒ½ç·¨è¼¯ã€ç›´æ¥é€²å…¥ç·¨è¼¯å™¨</p>
                    <p style="margin: 5px 0;">ğŸ”„ å¦‚éœ€æ›´æ–°å€‹è³‡ï¼Œè«‹é»æ“Šã€Œé‡æ–°ç™»å…¥ã€</p>
                    <p style="margin: 3px 0; font-size: 12px; opacity: 0.8;">ğŸ‘¤ LINE ID: ${userData.userId.substring(0, 8)}...</p>
                `;
                editBtn.innerHTML = 'âš¡ æ™ºèƒ½ç·¨è¼¯';
                editBtn.style.background = 'rgba(0,255,0,0.9)';
                editBtn.style.color = 'white';
            } else {
                // æœªç™»å…¥æˆ–ç™»å…¥å·²éæœŸ
                statusContent.innerHTML = `
                    <p style="margin: 5px 0;">âŒ <strong>æœªç™»å…¥</strong> - å°šæœªç²å–LINEå€‹äººè³‡æ–™</p>
                    <p style="margin: 5px 0;">ğŸ¯ é»æ“Šã€Œæ™ºèƒ½ç·¨è¼¯ã€å°‡å¼•å°æ‚¨ç™»å…¥</p>
                    <p style="margin: 5px 0;">ğŸ’¡ ç™»å…¥å¾Œå¯äº«å—å€‹äººåŒ–ç·¨è¼¯é«”é©—</p>
                    <p style="margin: 3px 0; font-size: 12px; opacity: 0.8;">ğŸ”§ <a href="#" onclick="clearLoginData(); checkLoginStatus(); return false;" style="color: #ffd700;">æ¸…é™¤ç™»å…¥å¿«å–</a></p>
                `;
                editBtn.innerHTML = 'âš¡ æ™ºèƒ½ç·¨è¼¯';
                editBtn.style.background = 'rgba(255,193,7,0.9)';
                editBtn.style.color = '#000';
            }
        }
        
        // æ¸…é™¤ç™»å…¥è³‡æ–™çš„å‡½æ•¸
        function clearLoginData() {
            localStorage.removeItem('lineUserProfile');
            localStorage.removeItem('lineAuthCompleted');
            alert('ğŸ§¹ ç™»å…¥å¿«å–å·²æ¸…é™¤ï¼');
        }
        
        function smartEdit() {
            console.log('ğŸš€ ç°¡åŒ–æ™ºèƒ½ç·¨è¼¯ç³»çµ± - ç›´æ¥è·³è½‰åˆ°MTEST');
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            const editBtn = document.getElementById('editBtn');
            if (editBtn) {
                editBtn.innerHTML = 'ğŸ”„ è¼‰å…¥ä¸­...';
                editBtn.style.background = 'rgba(108,117,125,0.8)';
                editBtn.disabled = true;
            }
            
            // ç›´æ¥è·³è½‰åˆ° mcard-mtest.htmlï¼Œè®“å®ƒè‡ªå·±è™•ç†æ‰€æœ‰èªè­‰é‚è¼¯
            // ä¸å†éœ€è¦è¤‡é›œçš„èªè­‰æª¢æŸ¥å’Œå¤šé‡è·³è½‰
            setTimeout(() => {
                window.location.href = '/mcard-mtest.html?source=mtest-index';
            }, 300);
        }
        
        function forceLogin() {
            console.log('ğŸ”„ ç°¡åŒ–é‡æ–°ç™»å…¥æµç¨‹');
            
            // æ¸…é™¤èˆŠçš„èªè­‰è³‡æ–™
            localStorage.removeItem('lineUserProfile');
            localStorage.removeItem('lineAuthCompleted');
            localStorage.removeItem('authTimestamp');
            
            // æ›´æ–°ç™»å…¥ç‹€æ…‹é¡¯ç¤º
            checkLoginStatus();
            
            // ç›´æ¥è·³è½‰åˆ°MTESTï¼Œè®“å®ƒè™•ç†é‡æ–°ç™»å…¥
            setTimeout(() => {
                window.location.href = '/mcard-mtest.html?source=mtest-index&forceLogin=true';
            }, 500);
        }


    </script>
</body>
</html> 